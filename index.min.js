var link = document.createElement("link");
function base64UrlDecode(e) {
  return (
    (e = e.replace(/-/g, "+").replace(/_/g, "/")),
    decodeURIComponent(escape(atob(e)))
  );
}
function escapeHtml(e) {
  return e
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#039;");
}
link.setAttribute("rel", "stylesheet"),
  link.setAttribute("type", "text/css"),
  link.setAttribute(
    "href",
    "https://fonts.googleapis.com/css?family=Open+Sans:800"
  ),
  document.head.appendChild(link);
var sbBoW = sbBoW || {
  draw: function (e, t, l, o, s) {
    var n = document.createElement("div");
    switch (
      ((n.id = "wrapperFloatingBtn"),
      (n.className = "wrapper-floatingBtn"),
      (n.style.position = "fixed"),
      (n.style.zIndex = 9999997),
      l)
    ) {
      case "position-bottom-middle":
        (n.style.display = "flex"),
          (n.style.alignItems = "end"),
          (n.style.justifyContent = "center"),
          (n.style.bottom = "20px"), // Mengatur jarak dari bawah
          (n.style.bottom = "0"),
          (n.style.left = "0"),
          (n.style.width = "100%"),
          (n.style.height = "100%");
        break;
      case "position-top-middle":
        (n.style.display = "flex"),
          (n.style.alignItems = "start"),
          (n.style.justifyContent = "center"),
          (n.style.bottom = "20px"), // Mengatur jarak dari bawah
          (n.style.top = "0"),
          (n.style.left = "0"),
          (n.style.width = "100%"),
          (n.style.height = "100%");
        break;
      case "position-bottom-left":
        (n.style.left = "0"), (n.style.bottom = "0");
        break;
      case "position-top-left":
        (n.style.top = "0"), (n.style.left = "0");
        break;
      case "position-bottom-right":
      default:
        (n.style.bottom = "0px"), (n.style.right = "0px");
        break;
      case "position-top-right":
        (n.style.top = "0px"), (n.style.right = "0px");
    }
    var d = document.createElement("div");
    (d.className = "floating-btn"), (d.style.padding = "25px");
    var i = document.createElement("button");
    (i.id = "btnModal"),
      (i.className = "btn border-radius25"),
      (i.role = "button"),
      (i.style.backgroundColor = o),
      (i.style.cursor = "pointer"),
      (i.style.color = "white"),
      (i.style.border = "1px solid " + o),
      (i.style.maxWidth = "200px"),
      (i.style.borderRadius = "25px"),
      (i.style.fontFamily = "'Open Sans'"),
      (i.style.fontStyle = "normal"),
      (i.style.fontWeight = "800"),
      (i.style.fontSize = "16px"),
      (i.style.lineHeight = "140%"),
      (i.style.minHeight = "47px"),
      (i.style.textAlign = "center"),
      (i.style.padding = "14px 16px"),
      (i.style.color = s),
      (i.style.webkitBorderRadius = "25px"),
      (i.style.mozBorderRadius = "25px"),
      (i.style.msBorderRadius = "25px"),
      (i.style.oBorderRadius = "25px"),
      (i.style.wordWrap = "break-word"),
      (decodedText = base64UrlDecode(t)),
      console.log(decodedText),
      (escapedText = escapeHtml(decodedText)),
      console.log(escapedText),
      (i.innerHTML = escapedText);
    var a = document.createElement("div");
    (a.id = "sbModalOverlay"),
      (a.style.display = "none"),
      (a.style.position = "fixed"),
      (a.style.top = "0"),
      (a.style.left = "0"),
      (a.style.width = "100%"),
      (a.style.height = "100%"),
      (a.style.background = "rgba(0, 0, 0, 0.5)"),
      (a.style.zIndex = 9999998);
    var r = document.createElement("div");
    (r.id = "sbModal"),
      (r.style.display = "none"),
      (r.style.position = "fixed"),
      (r.style.top = "50%"),
      (r.style.left = "50%"),
      (r.style.transform = "translate(-50%, -50%)");
    var y = window.innerWidth > 0 ? window.innerWidth : screen.width;
    (r.style.width = y >= 700 ? "700px" : y - 32 + "px"),
      (r.style.height = "100vh"),
      (r.style.overflowY = "hidden"),
      (r.style.zIndex = 9999999);
    var p = document.createElement("iframe");
    (p.id = "sbIframe"),
      (p.src =
        "https://sociabuzz.com/" + e + "/bow?ref=" + window.location.href),
      (p.allow = "microphone"),
      (p.style.width = "100%"),
      (p.style.border = 0),
      (p.height = "100%"),
      (p.frameborder = 0),
      r.appendChild(p),
      d.appendChild(i),
      n.appendChild(d),
      document.body.appendChild(n),
      document.body.appendChild(a),
      document.body.appendChild(r),
      (i.onclick = function () {
        (document.getElementById("sbModalOverlay").style.display = "block"),
          (document.getElementById("sbModal").style.display = "block");
      }),
      (document.getElementById("sbModalOverlay").onclick = function () {
        (document.getElementById("sbModalOverlay").style.display = "none"),
          (document.getElementById("sbModal").style.display = "none");
      });
  },
};
window.addEventListener("resize", function (e) {
  var t = window.innerWidth > 0 ? window.innerWidth : screen.width,
    l = document.getElementById("sbModal");
  l.style.width = t >= 700 ? "700px" : t - 32 + "px";
}),
  window.addEventListener("message", function (e) {
    "close.modal" == e.data.type &&
      ((document.getElementById("sbModalOverlay").style.display = "none"),
      (document.getElementById("sbModal").style.display = "none"));
  });
